
<!DOCTYPE html>
<html lang="en" class="no-js no-touch">
  <head>

    <link type="text/css" rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro">
    
<meta charset="utf-8" />


<title>
  
    Encryption
  
</title>





<meta name="author" content="https://plus.google.com/+KyawTun-Yathit/posts" />



<meta name="description" content="Transparent data encryption provided by YDN-DB that offers encryption of data at rest. " />


<link rel="icon" href="/favicon.ico" />

<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta id="viewport" name="viewport" content="width=device-width, initial-scale=1" />

<meta name="twitter:card" content="summary">
<meta property="twitter:account_id" content="@yathit" />
<meta property="twitter:site" content="@yathit" />
<meta property="twitter:description" content="" />
<meta property="twitter:creator" content="@yathit" />
<meta property="twitter:image:src" content="/ydn-db/imgs/logo.png" />


<link rel="author" href="https://plus.google.com/+KyawTun-Yathit/posts">
<link rel="publisher" href="https://plus.google.com/+KyawTun-Yathit">

<meta itemprop="name" content="
  
    Encryption
  
">
<link itemprop="image" href="/imgs/logo.png">
<meta itemprop="description" content="Transparent data encryption provided by YDN-DB that offers encryption of data at rest. ">

<meta property="og:site_name" content="Yathit" />
<meta property="og:title" content="
  
    Encryption
  
" />
<meta property="og:type" content="website" />
<meta property="og:url" content="/ydn-db/" />
<meta property="og:image" content="/ydn-db/imgs/logo.png" />

<link rel="chrome-webstore-item" href="https://chrome.google.com/webstore/detail/iccdnijlhdogaccaiafdpjmbakdcdakk">
<link rel="chrome-webstore-item" href="https://chrome.google.com/webstore/detail/ldikiokclnbceabnlbkabmcacpiednop">

<link rel="stylesheet" media="screen" href="/css/styles.min.css" />

<script src="/js/analytics.js"></script>

  </head>

  <body class="page-doc page--article article--ydndb-using theme--ydndb-using" itemscope itemtype="http://schema.org/TechArticle">
    

    <header class="main-header">

	























<nav class="main-nav">

  <header class="main-nav__header">
    <span class="main-nav__current-label">Encryption</span>
  </header>

  <ul class="main-nav__list clear">
  
    
    
    <li class="main-nav__item main-nav__item--<strong>ydn-db</strong>
                main-nav__item--home 
               
               
               ">
      <a class="main-nav__link main-nav__link--parent" href="/ydn-db/index.html" title="Go to <strong>YDN-DB</strong>">

        <strong>YDN-DB</strong>

        
        <i class="main-nav__icon icon icon-chevron-right"></i>
        
      </a>

      

    </li>
    
  
    
    
    <li class="main-nav__item main-nav__item--download
               
               
                 
               
               
               ">
      <a class="main-nav__link main-nav__link--parent" href="/ydn-db/downloads.html" title="Go to Download">

        Download

        
        <i class="main-nav__icon icon icon-chevron-right"></i>
        
      </a>

      

    </li>
    
  
    
    
    <li class="main-nav__item main-nav__item--documentation
               
               
                 
               
               
               ">
      <a class="main-nav__link main-nav__link--parent" href="/ydn-db/doc/index.html" title="Go to Documentation">

        Documentation

        
        <i class="main-nav__icon icon icon-chevron-right"></i>
        
      </a>

      

    </li>
    
  
    
    
    <li class="main-nav__item main-nav__item--api
               
               
                 
               
               
               ">
      <a class="main-nav__link main-nav__link--parent" href="/ydn-db/api/ydn/db/storage.html" title="Go to API">

        API

        
        <i class="main-nav__icon icon icon-chevron-right"></i>
        
      </a>

      

    </li>
    
  
    
    
    <li class="main-nav__item main-nav__item--examples
               
               
                 
               
               
               ">
      <a class="main-nav__link main-nav__link--parent" href="//dev.yathit.com/ydn-db/doc/example/index.html" title="Go to Examples">

        Examples

        
        <i class="main-nav__icon icon icon-chevron-right"></i>
        
      </a>

      

    </li>
    
  
    
    
    <li class="main-nav__item main-nav__item--github
               
               
                 
               
               
               ">
      <a class="main-nav__link main-nav__link--parent" href="https://github.com/yathit/ydn-db" title="Go to GitHub">

        GitHub

        
        <i class="main-nav__icon icon icon-chevron-right"></i>
        
      </a>

      

    </li>
    
  

  <li class="main-nav__item right">
    <a class="main-nav__link main-nav__link--parent" id="user-login">...</a>
  </li>
  <li class="main-nav__item right">
    <span class="main-nav__link main-nav__link--parent" id="user-name" style="display: none;"></span>
  </li>

  </ul>
  <button class="main-nav__btn btn--toggle-nav">
    <i class="icon icon-menu"></i>
  </button>

</nav>


</header>


    <div class="article-container" itemprop="text">

       <div class="ydn-breadcrumb-before"></div>
        <div class="container">
           <div class="content">
             <div id="ydn-breadcrumb" name="ydndb-doc"></div>
           </div>
        </div>
        <div class="ydn-breadcrumb-after"></div>

      <div class="editorial-header">
        <div class="container">
          <div class="content">

            <h1 class="editorial-header__title"></h1>
            <h2 class="editorial-header__subtitle" itemprop="name">Encryption</h2>

            <p class="editorial-header__excerpt" itemprop="headline">Transparent data encryption provided by YDN-DB that offers encryption of data at rest. </p>

          </div>
        </div>
      </div>


      <div class="container"><div class="content ">

    <h2 id="transparent-data-encryption">Transparent Data Encryption</h2>

    <p>Browser database are mainly secured by <a href="http://www.w3.org/Security/wiki/Same_Origin_Policy">single origin policy</a>, such that only your web application can access the database. This is good enough for most web application. However, if user OS is compromised or physically accessible by intruders, browser database has no security provision. Transparent data encryption is a well-known technology provided by YDN-DB that offers encryption of data at rest. This may provide the ability to comply with many laws, regulations, and guidelines established in various industries, when caching sensitive data on client side.</p>

    <h3 id="enabling-store-wise-encryption">Enabling store wise encryption</h3>

    <p>Application must provide cryptographically strong pseudo-random encryption key on opening the database for encryption. Use standard symmetric key generation library available on your server. Do not persist encryption key on client, but always transfer over SSL after user login. The key should be generated per user basic.</p>

    <p>Encryption key(s) are provided as Encryption field on database options. Encryption is enabled on store-wise using same encryption key for whole database. To enable encryption a store, set encrypted to true on its store schema.</p>

    <p>Encrypted store must use out-of-line key and must not use key generator as illustrated in following schema. The following code snippets can be run on browser dev console.</p>

    <pre><code> var schema = {
    version: 1,
    stores: [{
      name: 'encrypt-store',
      encrypted: true
    }]
 };
 var options = {
    Encryption: {
      expiration: 1000*15, // optional data expiration in ms.
      encryptKey: false,   // optional encrypt primary key
      method: 'rc4', // default is 'acs-cbc'
      secrets: [{
        name: 'aaaa',
        key: 'aYHF6vfuGHpfWS*eRLrPQxZjSó~É5c6HjCscqDqRtZasp¡JWSMGaW'
      }]
    }
 };

 var db = new ydn.db.Storage('encrypted-db-name', schema, options);
</code></pre>

    <p>Record key is hashed with SHA256 function using given encryption key. The field, secrets, has array of encryption key and name. A short key name is keep along with the unencrypted record for later used. Record value is encrypted with RC4 streaming cipher using per-record 64-bit random salt and encryption key. AES and CBC cipher is also available. See <a href="http://docs.closure-library.googlecode.com/git/class_goog_crypt_Sha256.html">goog.crypt.Sha256</a> and <a href="http://docs.closure-library.googlecode.com/git/class_goog_crypt_Arc4.html">goog.crypt.Arc4</a> for detail implementation.</p>

    <p>You may also set expiration interval in milli-seconds to let record to be expired. However noted that the data itself does not expired. The expiration time is a meta data to check on retrieval. If it expires, the record is removed from the database. These meta data can be manipulated if encryption is successful.</p>

    <p>By default, primary key is not encrypted. To encrypt primary key, set <code>encryptKey</code> to true.</p>

    <p>Inside database, encrypted record value has four meta data 1) key name 2) salt 3) creation timestamp 4) expiration time and encrypted value. Since record key is hashed, both encryption key and record key is required to retrieve a correct record.</p>

    <h3 id="using-encryption">Using encryption</h3>

    <p>Once enabled encryption, record is encrypted on write and decrypted back on read. Encryption and decryption is performed only on CRUD database operations. Database query, such as keys, values, returns unencrypted values.</p>

    <pre><code>var value = {msg: 'Hello world'};
var id = 'id1';
db.put('encrypt-store', value, id); // value and record_id encrypted on database
db.values('encrypt-store').done(function(values) {
    console.log(values); // unencrypted values
});
db.get('encrypt-store', id).done(function(value) {
    console.log(value); // decrypted record value
});
</code></pre>

    <p>Since data is encrypted, database indexing is not available.</p>

    <p>In this example, you will also find that record can no longer be retrieved after expiration of 15 seconds.</p>

    <p>Note that enabling encryption itself, does not encrypt data.</p>

    <h2 id="encryption-key-rotation">Encryption key rotation</h2>

    <p>With symmetric encryption, the level of confidentiality depends on the protection of the keys. To reduce exposure of key, encryption keys are updated periodically.</p>

    <p>Multiple encryption keys can be provided. Only the first key is used for encryption. All keys are used for decryption until success. Decryption is deem considered success if require key is available and encrypted value can be parsed by JSON parser.</p>

    <p>See <a href="http://yathit.github.io/ydndb-demo/encrypt/todo.html">demo application</a> to try out.</p>

    <p>Full source code is available for <a href="https://www.yathit.com/shop/ydn-db-subscription.html">yearly premium subscriber</a>.</p>

    <h2 id="crypto-module">Crypto module</h2>

    <p><a href="/api/ydn/crypto/Cipher.html">Crypto module</a> can be used without ydn-db, if record key is not necessary to be encrypted. Using crypto module outside of ydn-db provides more flexible usage. </p>

    <p>A cipher instance is created by providing Encryption Options as follow:</p>
    <pre>var options = {
  exposeKey: true, // optional
  secrets: [{
   name: 'aaaa',
   key: 'aYHF6vfuGHpfWS*eRLrPQxZjSó~É5c6HjCscqDqRtZasp¡JWSMGaW'
  }]
};
var cipher = new ydn.crypto.Cipher(options);
</pre>

    <p>Above example exposes encryption key, such that encryption is relying on master key in trade of for simple usage as follow:</p>

    <pre>var encrypted = cipher.encrypt({msg: 'This is a scret'});</pre>

    <p>Notice that the <code>encrypted</code> object has <code>key</code> attribute, which can be used for referencing as a primary key.</p>

    <p>It is decrypted by:</p>

    <pre>var original = cipher.decrypt(encrypted);</pre>

    <p>See <a href="http://yathit.github.io/ydndb-demo/encrypt/crypto-example.html">full example</a>.</p>

    <p>In using with YDN-DB, encrypted object can expose additional metadata for indexing. See <a href="http://yathit.github.io/ydndb-demo/encrypt/crypto-with-index.html">crypto with index example</a> which demonstrates query meta data on encrypted record. Note meta data for index are expose of encrypted message.</p>

    <p>Set <code>encryptKey</code> to <code>true</code> if you do not want to expose raw key, but instead, its hash value. </p>

  </div></div>


      <div class="container clear-both">
        <div class="content">

          <div class="container-medium">
  <nav class="article-nav">
  
    <a class="article-nav-link article-nav-link--prev" title="Previous article" href="/ydn-db/doc/usage/blob.html">
      Previous 'File and Blob'
    </a>
  
  
    <a class="article-nav-link article-nav-link--next" title="Next article" href="/ydn-db/doc/usage/debugging.html" style="float: right;">
      Next 'Debugging'
    </a>
  
  </nav>
</div>


          <br /><div class="g-comments" data-href="/ydn-db/ydn-db/using/encryption.html"></div>
        </div>
      </div>



      
        





      
      




<script src="/jsc/ydn.db-isw-core-crypt-qry-dev.js"></script>

    </div> <!-- /.article-container -->
    <div class="container clear">
	<div id="gc-content-license" class="gc-content-license g-wide--3 g-wide--last" >
		
		<div class="container clear">
	<div class="g-wide--3 g-wide--last">
    
		<h4>Authors</h4>
		
		
    <a href="/resources/contributors/index.html#kyawtun">
      Kyaw Tun</a>
		
    
	</div>
</div>

	</div>
</div>

    <footer class="main-footer">
  <div class="main-footer__container container clear">
    <div class="main-footer__list-group">
      <ul class="main-footer__list main-footer__list--primary">
      

        

        
        <li class="sitemap__item sitemap__item--<strong>ydn-db</strong>  sitemap__item--home  ">
          <a class="sitemap-list__link sitemap-list__link--parent" href="/ydn-db/index.html" title="Go to <strong>YDN-DB</strong>">
            <strong>YDN-DB</strong>
          </a>
        </li>
        
      

        

        
        <li class="sitemap__item sitemap__item--download  ">
          <a class="sitemap-list__link sitemap-list__link--parent" href="/ydn-db/downloads.html" title="Go to Download">
            Download
          </a>
        </li>
        
      

        

        
        <li class="sitemap__item sitemap__item--documentation  ">
          <a class="sitemap-list__link sitemap-list__link--parent" href="/ydn-db/doc/index.html" title="Go to Documentation">
            Documentation
          </a>
        </li>
        
      

        

        
        <li class="sitemap__item sitemap__item--api  ">
          <a class="sitemap-list__link sitemap-list__link--parent" href="/ydn-db/api/ydn/db/storage.html" title="Go to API">
            API
          </a>
        </li>
        
      

        

        
        <li class="sitemap__item sitemap__item--examples  ">
          <a class="sitemap-list__link sitemap-list__link--parent" href="//dev.yathit.com/ydn-db/doc/example/index.html" title="Go to Examples">
            Examples
          </a>
        </li>
        
      

        

        
        <li class="sitemap__item sitemap__item--github  ">
          <a class="sitemap-list__link sitemap-list__link--parent" href="https://github.com/yathit/ydn-db" title="Go to GitHub">
            GitHub
          </a>
        </li>
        
      
      </ul>

      <div class="main-footer__google-section">
        <h3 class="main-footer__title"><a href="/ydn-db/">
          <img id="developers-logo-footer" src="/imgs/yathit-dev-network.svg" alt="Yathit Developer Network logo">
        </a></h3>
        <ul class="main-footer__list main-footer__list--secondary google-list">
          <li><a href="https://www.yathit.com/">Yathit</a></li>
          <li><a href="https://www.yathit.com/terms.html">Terms of Service</a></li>
          <li><a href="https://www.yathit.com/privacy.html">Privacy Policy</a></li>
        </ul>
      </div>
    </div>
  </div>
</footer>

    <script src="/jsc/prettify.js"></script>

    
<script src="/js/script.js"></script>
<script src="/jsc/website-app.js"></script>
<script src="https://apis.google.com/js/client.js?onload=handleClientLoad"></script>





  </body>
</html>

